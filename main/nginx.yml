- name: Pull Docker image for Nginx
  tags:
    - pull-nginx
    - pull-all
  docker_image:
    name: nginx
    tag: 1.11.6

- name: Start Nginx container
  tags:
    - start-nginx
    - start-all
  docker_container:
    name: nginx
    image: nginx:1.11.6
    network_mode: host
    hostname: nginx
    ports:
      - 80:80
      - 443:443
    restart_policy: no
    volumes:
      - '/home/ubuntu/nginx/conf.d/:/etc/nginx/conf.d/'
      - '/home/ubuntu/nginx/nginx.production.conf:/etc/nginx/nginx.conf'
      - '/home/ubuntu/nginx/html/:/etc/nginx/html/'
      - public:/var/www/public/

- name: Stop Nginx container
  tags:
    - stop-nginx
    - stop-all
  docker_container:
    name: nginx
    state: absent
